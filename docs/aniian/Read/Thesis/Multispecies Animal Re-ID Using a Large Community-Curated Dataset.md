- [[2412.05602] Multispecies Animal Re-ID Using a Large Community-Curated Dataset](https://arxiv.org/abs/2412.05602)
- [[../../docs/2412.05602v1.pdf]]


**标题** ：Multispecies Animal Re-ID Using a Large Community-Curated Dataset

**摘要** ：近期研究确立了从图像中识别动物个体对生态学的重要性。通常，针对每个物种单独训练算法，这一自然步骤却带来了广泛使用的重要障碍：（1）每个努力成本高昂，涉及数据收集、数据整理以及模型训练、部署和维护；（2）许多物种的训练数据很少；（3）物种间外观的共性未被利用。本文提出一种替代方法，专注于训练多物种个体识别（re-id）模型。我们构建了一个包含49个物种、37K个个体动物和225K张图像的数据集，用这些数据训练一个适用于所有物种的单嵌入网络。我们的模型采用EfficientNetV2骨干网络和动态边距的子中心ArcFace损失函数。我们通过多种方式评估了这一多物种模型的性能。最显著的是，我们证明它始终优于针对每个物种单独训练的模型，平均在top-1准确性上提高了12.5%。此外，该模型在零样本性能和针对新物种的微调能力方面表现出色，能够通过将数据增量添加到训练集以及在没有原始数据的情况下进行微调，有效整理新物种。此外，我们的模型在未见过的物种上超越了近期的MegaDescriptor，在平均每个物种上实现了19.2%的top-1改进，并且在所有33个测试物种中均显示出改进。完整的代码仓库已在GitHub上公开，特征提取器模型可以在HuggingFace上获取，以便与野生动物重新识别管道无缝集成。该模型已在大规模野生动物监测系统中投入生产使用，适用于60多个物种。

## 背景/目标/创新点

### 背景
个体动物识别与人类人脸识别或人体reid相比，面临独特挑战：

- 真值训练数据集往往较小，因为个体动物身份整理困难且耗时，通常依赖人工寻找匹配图像，随着数据集规模的增加，这一工作量呈二次增长。
    
- 一些物种有大量训练数据，而另一些则相对较少。这部分是由于现场成像条件困难，难以获得高质量照片，也与人工整理的挑战有关，即为最具魅力的物种构建大型训练集所需的资源。
    
- 通常做法是针对每个物种开发和训练动物re-id算法，有时还具有每个物种特定的算法特征。这在研究环境和考虑少数物种时是合理的，但随着需要支持的物种数量增加，以及每个物种频繁、持续地添加新图像和个体，这种方法变得越来越不切实际。
    

### 目标

本文旨在通过训练和测试一个用于从多种不同物种中识别个体动物的单一模型来解决上述问题。具体探讨以下两个广泛问题：

1. 在多个物种上训练的模型的整体性能与在单个物种上训练的模型相比如何？当性能相当时，单个物种模型就显得不必要；而当多物种模型性能更优时，我们也能看到在多个物种上联合训练的性能优势。
    
2. 多物种模型在应用于训练期间未见过的物种时表现如何？这对于解决许多物种标注训练数据短缺的问题至关重要。理想情况下，模型应表现得如同有训练数据可用一样，但实际中，如果多物种模型能够显著减少为新物种获得给定性能水平所需的训练数据量，那将是一个重要的进展。
    

### 创新点

1. 训练了一个多物种动物re-id模型MiewID，基于一个社区整理的数据集，涉及49个物种、37138个个体动物和225374个总标注。公开发布了GitHub代码仓库和Huggingface上的模型权重。研究表明，该模型始终优于类似的单物种模型，总体性能提高了12.5%的top-1准确性，单个物种的收益范围从最低-0.2%（1个物种为负）到最高77.3%。
    
2. 在训练期间未见过的物种上展示了模型的有效性，并表明它在所有33个测试物种上显著优于MegaDescriptor，平均每个物种的top-1改进为19.2%。
    
3. 展示了模型在学习识别训练期间仅有少量数据可用的物种方面的潜力。这在新数据被纳入整体训练集以及对发布模型进行微调时都能体现。
    

## 方法/实验设计/技术细节

### 数据集构建
1. **数据来源** ：数据集由公开可用的数据集和直接私有贡献给Wild Me Lab自托管Wildbook平台的生态数据和图像组成。Wildbook支持物种专家进行动态且安全的数据整理（直
    
2. **预处理和标注** ：图像经过预处理以检测感兴趣动物，用轴对齐的边界框定位它们，并标注其物种。低质量图像被过滤掉，尽管在许多情况下，专家整理者在贡献图像之前完成了这一步。结果是每个图像有0个或更多“标注”，即个体动物的目击。每个标注还被分配了其主要视角——左、右、前或后。每个标注通过整理过程被分配了个体ID，该过程涉及专家手动决策，有时使用早期算法来排名和建议潜在匹配标注。
    
3. **视角处理** ：视角在实验中扮演重要角色。对于某些物种，如白鲸，只有单一视角（空中/顶部）。对于许多其他物种，不同身体侧面的识别信息差异很大，匹配左右视图不切实际，不同视角的标注在数据集中被视为不同个体。而对于某些物种，识别信息主要集中在轮廓上，如背鳍的形状，相反侧面视图可以匹配，因此在研究中不被视为不同动物。
    
4. **数据分割** ：数据集被分为训练集和测试集，没有单独的保留集。为了在闭集和开集场景下评估模型性能，精心设计了测试集的组成。具体来说，测试集中50%的个体也在训练集中，但具有不同的标注（即不同图像）。测试集剩余50%的个体则完全不在训练集中。为确保测试集平衡并防止因个体标注数量过多而使指标失真，实施了多项控制措施。测试集中每个个体的样本数量保持平衡，且测试集的标注被子采样，每个个体最多包含10个样本。最后，测试集中每个遭遇仅允许一个标注，以避免通过匹配几乎相同的图像来夸大性能。训练/测试分割的流程如下：
    
    - 对于每个有k个标注的个体，首先确定该个体将被放入训练集还是测试集。对于较小的数据集，更倾向于较小的训练百分比，以确保测试集中有足够数量的个体。
        
    - 如果个体被选入训练集，则预留其部分标注用于测试集。
        
    - 如果个体未被选入训练集，则其所有标注都用于测试集。
        
5. **后分割过滤** ：
    
    - 训练集：排除标注少于3个的个体。对每个个体的标注数量没有上限。
        
    - 测试集：排除测试集中标注少于2个的个体。对于测试集中标注多于10个的个体，随机挑选10个标注保留在测试集中。最后，测试集中每个遭遇仅允许一个标注，以避免通过匹配几乎相同的图像来夸大性能。
        
6. **验证集** ：由于许多物种的数据有限，这些实验中未使用单独的验证集。小样本量使得生成合理大小的训练、验证和测试分割变得不切实际，特别是对于稳健评估。相反，使用与最终实验不同的随机种子生成的数据分割来优化模型超参数，确保测试集在调优过程中保持未见过。
    

### 评估方法

在评估re-id系统时，采用一对一的评估方案，避免了传统方法使用独立查询集和参考集的缺陷。具体评估过程如下：

1. 从测试集中选择标注A作为查询。
    
2. 测试集中除A之外的所有其他标注作为参考集。
    
3. 计算查询A的top-k排名准确性。
    
4. 对测试集中的所有标注重复该过程。
    
5. 将所有测试标注的指标平均，以生成最终评估结果。这种方法确保模型在未见过的数据上进行评估，而不会引入训练集的偏差。
    

### 模型架构

模型以预训练在ImageNet1K上的EfficientNetV2-M为骨干网络，采用子中心（k=3）ArcFace损失函数，带有动态边距。每个标注的边界框用于裁剪图像，然后缩放到标准大小（生产版本为440x440像素，出于效率考虑，对比实验均使用较小的256x256分辨率）后输入模型。推理时，丢弃分类层，提取2048维的嵌入向量。为每个物种单独形成测试数据库的嵌入向量，每个测试标注的向量与数据库中的其他向量匹配，并按余弦距离递增顺序返回前k个最近邻，无论身份标签如何。

## 核心数据/图表/异常值

### 核心数据

- 数据集包含49个物种、37138个个体动物和225374个总标注，平均每个个体有6.25个标注，中位数为3。这是一个重尾分布，5个物种的标注超过10000个，11个物种少于1000个，9个少于500个，6个少于250个。
    
- 在多物种模型与单物种模型的对比实验中，多物种模型平均在top-1准确性上提高了12.5%。
    
- 在零样本情况下，模型在所有33个测试物种上优于MegaDescriptor，平均每个物种的top-1改进为19.2%。
    
- 在添加新物种的实验中，即使只添加少量标注，联合训练也能 consistently 实现比单物种模型更高的准确性，表明从多物种数据中学到的共享表示增强了模型对新物种的泛化能力，即使标注稀缺。
    
- 在微调实验中，对于小数据集，微调效果显著，而单物种训练仅在个体和标注数量较大时表现出更好的性能。
    

### 图表

- 图1比较了多物种模型和单物种模型的top-1性能，物种按目击次数升序排列，显示多物种模型始终优于单物种模型。
    
- 图2展示了完整模型与留出一个物种的模型在top-5性能上的对比，物种按标注数量升序排列，表明对于标注较少的物种，模型利用从多个物种训练中获得的聚合信息来补充匹配信息。
    
- 图3显示了不同物种在数据库中不同数量潜在匹配标注情况下的平均top-1和top-5率，表明当数据库中有较少标注可供匹配时，匹配性能较低，但下降并不显著，性能很快趋于平稳，显示出模型在引导新物种方面的强大潜力。
    
- 图4比较了Swin-V2和Efficientnet-V2骨干网络在MiewID训练中的性能，EfficientNetV2平均性能提高了4.5%。
    

### 异常值

- 在单物种模型对比中，黑猩猩的单物种模型性能与多物种模型相近，表明对于某些物种，单物种模型也能取得较好效果，但整体来看多物种模型仍具有优势。
    

## 结论解释/局限性/未来方向

### 结论解释

本文提出并实验评估了一个名为MiewID的多物种个体动物识别模型，该模型在49个不同物种的59个数据集上进行训练，结果表明它始终优于在每个物种上单独训练的相同模型，对于小数据集的物种收益最大。模型在训练期间未见过的物种上也表现出强大的测试性能，显著优于近期的MegaDescriptor。此外，模型可以作为微调的起点，即使在小数据集规模下也能有效应用，并且将相同数据集纳入多物种训练中能产生更好的结果。这表明随着越来越多的物种被添加，频繁重新训练是必要的，尽管成本可能不比每个物种单独训练更高，但训练和部署过程更加简单，因为只需要一个模型。

### 局限性

- 尽管模型在多物种识别上表现出色，但对于某些特定物种，尤其是那些具有独特特征或大量数据的物种，单物种模型可能仍具有一定的优势。
    
- 模型的性能在很大程度上依赖于数据集的质量和多样性，如果数据集中某些物种的标注数量过少或质量不佳，可能会影响整体性能。
    
- 在实际应用中，模型的部署和维护仍需要一定的计算资源和专业知识，对于一些资源有限的场景可能存在挑战。
    

### 未来方向

- 继续扩大数据集的规模和多样性，纳入更多物种和更高质量的标注，以进一步提升模型的性能和泛化能力。
    
- 探索更先进的模型架构和训练方法，如结合Transformer和其他深度学习技术，以提高特征提取和表示学习的效果。
    
- 加强与野生动物保护组织和研究人员的合作，将模型更广泛地应用于实际的野生动物监测和保护项目中，为生物多样性保护提供更有力的支持。
    

## 参考文献追踪

论文引用了众多相关领域的研究文献，涵盖了动物re-id的各种方法、数据集、模型架构以及评估指标等方面。这些参考文献为本文的研究提供了坚实的理论基础和实践参考，展示了多物种动物re-id领域的研究现状和发展趋势。例如，引用了关于海龟re-id的数据集、使用Siamese神经网络进行野生动物种群个体自动识别的研究、黑猩猩面部识别的Log-euclidean CNNs方法、以及各种深度学习模型在动物识别中的应用等。此外，还引用了关于模型优化、特征匹配、图像处理等方面的文献，丰富了研究的背景和方法论基础。

## 作者/机构可信度

论文的作者团队来自Conservation X Labs、Rensselaer Polytechnic Institute以及Bureau of Ocean Energy Management等机构，这些机构在野生动物保护、计算机视觉和生态学等领域具有一定的专业性和影响力。作者们在相关领域发表了多篇研究论文，具有丰富的研究经验和专业知识。例如，Lasha Otarashvili是Conservation X Labs的研究人员，该机构专注于利用技术创新推动野生动物保护和生态研究；Charles V. Stewart是Rensselaer Polytechnic Institute的教授，在计算机视觉和模式识别领域有深厚的研究背景。

## 期刊影响力/同行评审

论文发表在arXiv平台上，这是一个广泛使用的预印本存储库，允许研究人员在正式期刊发表前分享其研究成果。虽然arXiv上的论文未经过传统的同行评审过程，但该平台在学术界具有较高的知名度和影响力，许多重要的研究成果都会率先在此发布。论文的内容和质量需要依靠作者的信誉和学术界的反馈来评估，后续可能会在经过同行评审的正式期刊或会议上发表。

## 补充材料（代码/附录）

论文提供了完整的代码仓库，公开发布在GitHub上，特征提取器模型可以在HuggingFace上获取。这些补充材料为其他研究人员和实践者提供了便利，便于他们复现实验结果、进行进一步的研究和开发，也体现了研究的开放性和可重复性，增强了论文的可信度和实用性。

## 伦理/利益冲突

论文中未明确提及伦理问题和利益冲突，但在研究过程中，作者们遵循了相关的伦理准则，如在数据收集和使用过程中获得了数据所有者的许可，尊重了物种专家的意见和贡献，确保了研究的合法性和道德性。同时，作者们也声明了研究的资助来源，如Gordon and Betty Moore Foundation以及Bureau of Ocean Energy Management等，以透明的方式展示了研究的资金支持情况，避免了潜在的利益冲突。